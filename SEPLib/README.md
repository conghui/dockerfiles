## Introduction

It is well-known SEPLib tool set for seismic processing. The container has two main features:

1. Run a GUI applications from inside the container without sshd service, which is more straightforward.
2. You can shared a folder with the container to store files created by applications from inside the container. The files are owned by your **current** user and group instead of root, which is the default behaviors in docker container.

## How to build

```
docker build -t conghui/seplib .
```

## How to run

If you want to login in the container, you can run the `bash` program and do whatever you like.
```
docker run \
  -it \
  --rm \
  -e USER=`id -un $USER` \
  -e GROUP=`id -gn $USER` \
  -e LOCAL_USER_ID=`id -u $USER` \
  -e LOCAL_GROUP_ID=`id -g $USER` \
  -e "TERM=xterm-256color" \
  --net=host \
  --env=DISPLAY \
  --volume=${HOME}/.Xauthority:/home/$USER/.Xauthority:rw \
  --volume=`pwd`:/work \
  --workdir=/work \
  conghui/seplib bash

```

### inside the docker container

Inside the docker container, you can create and view a file.
```
Spike n1=10 n2=10 k1=5 k2=5 nsp=1 mag=1 | Grey pclip=100 | Xtpen
```

or you can save it
```
Spike n1=10 n2=10 k1=5 k2=5 nsp=1 mag=1 > v.H
```
In default, the actual binary data generated by `Spike` or other SEPLib commands are stored in a directory specified in `~/.datapath`, which in this case is the `/tmp/` inside the container. So, even you mount the current directory to the container, you can only access `v.H` (the header) when you leave the container. You will lose the binary file forever.

### Keep binary files persistant
There are two ways to keep the binary files avaiable when you both in or out of the container:

#### add `out=stdout` argument to every seplib command (recommended)
By adding `out=stdout` argument to the seplib commands, the header and the binary file will be combined into a single file. So the binary data will not lose if you can access the header file. For example

```
# inside the container
Spike n1=10 n2=10 k1=5 k2=5 nsp=1 mag=1 out=stdout > v.H

# leave container
exit
```

Next time when you run the container, you can still access it
```
# inside the container
Grey < v.H pclip=100 | Xtpen
```

#### use a `.datapath` file in the current working directory
If you use the command mentioned above to start the container, the `pwd` will be mapped to `work` in the container. Add a `.datapath` file in the current directory that explicitly set the datapath.

```
# inside the container
mkdir -p .sepdata  && echo "datapath=`pwd`/.sepdata/" > .datapath
Spike n1=10 n2=10 k1=5 k2=5 nsp=1 mag=1 > v.H
In v.H

# leave container
exit
```

Next time when you run the container, you can still access it
```
# inside the container
Grey < v.H pclip=100 | Xtpen
```

One of the advantages of this image is that you have full permission for the files you created inside the container. They are not owned by root, in which case you can't modify and remove them when you leave the container.
